<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Smart Traslados</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link rel="apple-touch-icon" href="/public/IMG_20260103_204207.png">
<link rel="manifest" href="/manifest.json">

<style>
  body { margin:0; font-family: Arial, sans-serif; background:#000; color:#fff; display:flex; flex-direction:column; align-items:center; justify-content:center; min-height:100vh; overflow: hidden; }
  .logo { width:120px; margin-bottom:20px; border-radius: 20px; }
  .login-card { background:#111; padding:25px; border-radius:20px; border:1px solid #333; width:85%; max-width:350px; text-align:center; position: relative; z-index: 1; }
  h1 { font-size:24px; color:#00c853; margin-bottom:20px; }
  
  input { width:100%; padding:18px; border-radius:12px; border:1px solid #444; background:#222; color:#fff; font-size:20px; margin-bottom:20px; box-sizing:border-box; text-align:center; }
  
  .btn-choice { width:100%; padding:20px; border-radius:12px; border:none; font-weight:bold; font-size:18px; cursor:pointer; margin-bottom:15px; display:flex; align-items:center; justify-content:center; gap:10px; transition: transform 0.2s; }
  .btn-choice:active { transform: scale(0.95); }
  .btn-pasajero { background:#00c853; color:#000; }
  .btn-chofer { background:#333; color:#fff; border: 1px solid #555; }
  
  /* Cartel de ayuda para iPhone mejorado */
  #ios-prompt {
    display: none; 
    position: fixed; 
    bottom: 30px; 
    left: 20px; 
    right: 20px; 
    background: #ffffff; 
    color: #000;
    padding: 15px; 
    border-radius: 18px; 
    text-align: center;
    box-shadow: 0 10px 40px rgba(0,0,0,0.8); 
    z-index: 9999;
    animation: slideUp 0.5s ease-out;
  }

  /* La flechita que se√±ala el bot√≥n de compartir de iPhone */
  #ios-prompt::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    border-left: 10px solid transparent;
    border-right: 10px solid transparent;
    border-top: 10px solid #ffffff;
  }

  @keyframes slideUp {
    from { transform: translateY(100px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }

  .ios-icon { width: 22px; vertical-align: middle; margin: 0 5px; }
  .close-prompt { display: block; margin-top: 10px; font-size: 12px; color: #666; text-decoration: underline; }
</style>
</head>
<body>

  <img src="/public/IMG_20260103_204207.png" class="logo">

  <div class="login-card">
    <h1>Smart Traslados</h1>
    <input type="tel" id="telefono" placeholder="Tu n√∫mero de celular">
    
    <button class="btn-choice btn-pasajero" onclick="ingresar('pasajero')">
        <span>üìç</span> BUSCAR TRASLADO
    </button>
    
    <button class="btn-choice btn-chofer" onclick="ingresar('chofer')">
        <span>üöñ</span> SOY CHOFER
    </button>
  </div>

  <div id="ios-prompt">
    <div style="font-size: 15px; line-height: 1.5;">
        <strong>¬°Instal√° la App en tu iPhone!</strong><br>
        1. Toc√° el bot√≥n <strong>Compartir</strong> <img src="https://img.icons8.com/ios/50/000000/sent.png" class="ios-icon"><br>
        2. Desliz√° y eleg√≠ <strong>"Agregar al inicio"</strong> <img src="https://img.icons8.com/ios/50/000000/plus-2-math.png" class="ios-icon">
    </div>
    <span class="close-prompt" onclick="document.getElementById('ios-prompt').style.display='none'">Cerrar ayuda</span>
  </div>

<script>
// 1. AUTO-LOGIN
const sesion = JSON.parse(localStorage.getItem("sesion") || "{}");
if(sesion.telefono && sesion.tipo){
    // Ajustamos rutas para que coincidan con tus carpetas
    window.location.href = (sesion.tipo === "chofer") ? "/chofer/index.html" : "/pasajero/index.html";
}

function ingresar(tipoElegido) {
    const tel = document.getElementById("telefono").value.trim();
    if (tel.length < 8) {
        alert("Por favor, ingres√° tu n√∫mero de tel√©fono.");
        return;
    }

    const datosSesion = { 
        telefono: tel, 
        tipo: tipoElegido, 
        nombre: "" 
    };
    localStorage.setItem("sesion", JSON.stringify(datosSesion));

    if(tipoElegido === 'chofer') {
        window.location.href = "/chofer/index.html";
    } else {
        window.location.href = "/pasajero/index.html";
    }
}

// 2. L√ìGICA DE DETECCI√ìN IPHONE
const isIos = () => /iphone|ipad|ipod/.test(window.navigator.userAgent.toLowerCase());
const isStandalone = () => ('standalone' in window.navigator) && (window.navigator.standalone);

// Solo mostramos el cartel si es iPhone Y si NO est√° abierta como App
if (isIos() && !isStandalone()) {
  setTimeout(() => {
    document.getElementById('ios-prompt').style.display = 'block';
  }, 1000); // Aparece 1 segundo despu√©s de cargar para que se note
}
</script>
</body>
</html>
